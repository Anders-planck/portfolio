---
title: 'Open Banking UI'
summary: 'Modern payment interface for open banking integration with multi-environment deployment and comprehensive internationalization'
image: '/images/projects/open-banking-ui.png'
author: 'Anders & A-Cube S.r.l.'
publishedAt: '2024-06-01'
tags: ['React', 'Vite', 'Material-UI', 'TypeScript', 'Open Banking', 'Payments']
---

## Overview

**Open Banking UI** is a production-ready payment interface application that provides seamless integration with open banking APIs. Built with React 18, Vite, and Material-UI, it delivers a secure and user-friendly experience for initiating payments, managing accounts, and viewing transaction history.

### Key Achievements

- 💳 **Secure Payment Flow**: PSD2-compliant payment initiation
- 🔒 **OAuth 2.0 Authentication**: Secure bank authorization
- 🌍 **Multi-Language Support**: React Intl for internationalization
- 📱 **Responsive Design**: Mobile-first approach with Material-UI
- ☁️ **AWS S3 Deployment**: Multi-environment deployment pipeline
- 📄 **PDF Viewing**: Integrated document viewer for bank statements
- ⚡ **Fast Build Times**: Vite with SWC for rapid development
- 🧪 **Mock Service Worker**: MSW for API mocking during development

---

## Technical Architecture

### System Design

```
┌──────────────────────────────────────────────────┐
│           Vite + React 18 Frontend                │
│      Payment Flow • Account Linking • History    │
└────────────────┬─────────────────────────────────┘
                 │
┌────────────────▼─────────────────────────────────┐
│         Redux Toolkit State Layer                 │
│   Auth • Payments • Accounts • Transactions      │
└──────┬──────────────────────────────┬────────────┘
       │                              │
┌──────▼──────────┐         ┌─────────▼────────────┐
│ Open Banking    │         │   Security Layer     │
│ APIs            │         │   - OAuth 2.0        │
│ - AISP          │         │   - PKCE Flow        │
│ - PISP          │         │   - Token Refresh    │
└─────────────────┘         └──────────────────────┘
```

### Core Features

**Payment Initiation Service Provider (PISP)**:
- Single immediate payments
- Recurring payments setup
- Payment status tracking
- Strong Customer Authentication (SCA) handling

**Account Information Service Provider (AISP)**:
- Account list retrieval
- Balance information
- Transaction history
- Account details

---

## Core Features

### 1. Payment Flow

**Payment Initiation**:
```typescript
import { usePayment } from '@/hooks/usePayment'
import { PaymentRequest } from '@/types/payment'

export function PaymentForm() {
  const { initiatePayment, loading, error } = usePayment()

  const handleSubmit = async (data: PaymentRequest) => {
    const result = await initiatePayment({
      creditorAccount: {
        iban: data.iban,
        currency: 'EUR'
      },
      instructedAmount: {
        amount: data.amount,
        currency: 'EUR'
      },
      debtorAccount: {
        iban: userAccount.iban
      },
      remittanceInformationUnstructured: data.description
    })

    if (result.success) {
      // Redirect to bank for authorization
      window.location.href = result.authorizationUrl
    }
  }

  return (
    <form onSubmit={handleSubmit}>
      <TextField label="Recipient IBAN" name="iban" required />
      <TextField label="Amount" name="amount" type="number" required />
      <TextField label="Description" name="description" />
      <Button type="submit" disabled={loading}>
        Initiate Payment
      </Button>
      {error && <Alert severity="error">{error.message}</Alert>}
    </form>
  )
}
```

**Strong Customer Authentication**:
```typescript
export function SCAHandler() {
  const { completeAuthentication } = useAuth()
  const location = useLocation()

  useEffect(() => {
    const params = new URLSearchParams(location.search)
    const code = params.get('code')
    const state = params.get('state')

    if (code && state) {
      completeAuthentication({ code, state })
    }
  }, [location])

  return (
    <Box>
      <CircularProgress />
      <Typography>Completing authentication...</Typography>
    </Box>
  )
}
```

### 2. Account Linking

**OAuth 2.0 + PKCE Flow**:
```typescript
import { generateCodeVerifier, generateCodeChallenge } from '@/utils/pkce'

export const useAccountLinking = () => {
  const initiateLink = async (bankId: string) => {
    // Generate PKCE challenge
    const codeVerifier = generateCodeVerifier()
    const codeChallenge = await generateCodeChallenge(codeVerifier)

    // Store verifier for callback
    sessionStorage.setItem('code_verifier', codeVerifier)

    // Build authorization URL
    const params = new URLSearchParams({
      response_type: 'code',
      client_id: process.env.VITE_CLIENT_ID!,
      redirect_uri: process.env.VITE_REDIRECT_URI!,
      scope: 'aisp pisp',
      state: generateRandomState(),
      code_challenge: codeChallenge,
      code_challenge_method: 'S256'
    })

    window.location.href = `${bankAuthUrl}?${params.toString()}`
  }

  const handleCallback = async (code: string) => {
    const codeVerifier = sessionStorage.getItem('code_verifier')!

    const tokens = await exchangeCodeForTokens({
      code,
      code_verifier: codeVerifier,
      grant_type: 'authorization_code'
    })

    return tokens
  }

  return { initiateLink, handleCallback }
}
```

### 3. Transaction History

**Infinite Scroll with Virtualization**:
```typescript
import { useInfiniteQuery } from '@tanstack/react-query'
import { useVirtual } from 'react-virtual'

export function TransactionList({ accountId }) {
  const {
    data,
    fetchNextPage,
    hasNextPage
  } = useInfiniteQuery({
    queryKey: ['transactions', accountId],
    queryFn: ({ pageParam = 0 }) =>
      fetchTransactions(accountId, { offset: pageParam }),
    getNextPageParam: (lastPage) => lastPage.nextOffset
  })

  const allTransactions = data?.pages.flatMap(p => p.transactions) || []

  const parentRef = useRef(null)
  const rowVirtualizer = useVirtual({
    size: allTransactions.length,
    parentRef,
    estimateSize: useCallback(() => 60, []),
    overscan: 5
  })

  useEffect(() => {
    const [lastItem] = [...rowVirtualizer.virtualItems].reverse()

    if (!lastItem) return

    if (lastItem.index >= allTransactions.length - 1 && hasNextPage) {
      fetchNextPage()
    }
  }, [
    hasNextPage,
    fetchNextPage,
    allTransactions.length,
    rowVirtualizer.virtualItems
  ])

  return (
    <div ref={parentRef} style={{ height: '600px', overflow: 'auto' }}>
      <div style={{ height: rowVirtualizer.totalSize }}>
        {rowVirtualizer.virtualItems.map(virtualRow => (
          <TransactionRow
            key={virtualRow.index}
            transaction={allTransactions[virtualRow.index]}
            style={{
              position: 'absolute',
              top: 0,
              transform: `translateY(${virtualRow.start}px)`
            }}
          />
        ))}
      </div>
    </div>
  )
}
```

### 4. Multi-Language Support

**React Intl Integration**:
```typescript
import { IntlProvider, FormattedMessage, FormattedNumber } from 'react-intl'

export function App() {
  const [locale, setLocale] = useState('en')
  const messages = useMemo(() => require(`./locales/${locale}.json`), [locale])

  return (
    <IntlProvider locale={locale} messages={messages}>
      <Router>
        <Routes />
      </Router>
    </IntlProvider>
  )
}

// Usage in components
function PaymentSummary({ amount, currency }) {
  return (
    <Box>
      <Typography>
        <FormattedMessage id="payment.total" />
      </Typography>
      <Typography variant="h4">
        <FormattedNumber
          value={amount}
          style="currency"
          currency={currency}
        />
      </Typography>
    </Box>
  )
}
```

---

## Build & Deployment

### Multi-Environment Configuration

```bash
# Development build
npm run build:dev  # Uses .env.dev

# Sandbox build
npm run build:sandbox  # Uses .env.sandbox

# Production build
npm run build:production  # Uses .env.production
```

### AWS S3 Deployment

**Deployment Script**:
```bash
#!/bin/bash

# Build for environment
npm run build:${ENV}

# Upload to S3
aws --profile=${AWS_PROFILE} s3 sync --delete ./dist s3://pay-${ENV}.acubeapi.com

# Invalidate CloudFront cache
aws --profile=${AWS_PROFILE} cloudfront create-invalidation \
  --distribution-id ${DISTRIBUTION_ID} \
  --paths "/*"
```

---

## Development Workflow

### Mock Service Worker Setup

**MSW Handlers**:
```typescript
import { rest } from 'msw'

export const handlers = [
  // Mock payment initiation
  rest.post('/api/payments', (req, res, ctx) => {
    return res(
      ctx.status(201),
      ctx.json({
        paymentId: '123-456-789',
        status: 'pending',
        authorizationUrl: 'https://bank.example.com/auth'
      })
    )
  }),

  // Mock account list
  rest.get('/api/accounts', (req, res, ctx) => {
    return res(
      ctx.status(200),
      ctx.json({
        accounts: [
          { id: '1', iban: 'DE89370400440532013000', balance: 1234.56 },
          { id: '2', iban: 'FR1420041010050500013M02606', balance: 5678.90 }
        ]
      })
    )
  })
]

// Start MSW
import { setupWorker } from 'msw'
const worker = setupWorker(...handlers)
worker.start()
```

---

## Technical Stack Summary

### Frontend
- React 18.2.0
- TypeScript 5.1.3
- Vite 4.3.9
- Material-UI 5.13.5
- React Router 6.13.0

### State & Data
- Redux Toolkit 1.9.5
- React Query (implied from infinite scroll)
- React Intl 6.4.4

### Development Tools
- MSW 1.2.2 - API mocking
- ESLint 8.43.0
- Prettier 2.8.8
- Husky 8.0.3

---

## Security Considerations

1. **OAuth 2.0 + PKCE**: Protection against authorization code interception
2. **SCA Compliance**: PSD2 Strong Customer Authentication
3. **Token Refresh**: Automatic token renewal
4. **Secure Storage**: Tokens stored in httpOnly cookies
5. **CSP Headers**: Content Security Policy for XSS protection

---

## Conclusion

**Open Banking UI** delivers a secure, user-friendly payment interface with full PSD2 compliance and modern development practices.

**License**: Proprietary (A-Cube S.r.l.)
